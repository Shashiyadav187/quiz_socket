<navbar></navbar>

<div class="container">
  
  <div class="row">
    <div class="col-lg-12">
      <h1 class="page-header">OSM: geolocalización</h1>
      <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
        <leaflet id="map" class="map-admin" center="Madrid"> </leaflet>  
        
      </div>
      <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
        <ul class="list-group address">
          <li class="list-group-item" ng-repeat="address in listAddress">
            
            <div ng-if="!address.edit">
                <a href="#" ng-show="isLoggedIn()" ng-click="deleteAddress(address)" title="Eliminar dirección" ><span class="glyphicon glyphicon-remove pull-right"></span></a>
                <a href="#" ng-show="isLoggedIn()" ng-click="editAddress(address)" title="Editar dirección" ><span class="glyphicon glyphicon-edit pull-right"></span></a>
                <strong ng-click="openPopup(address)" >{{address.road}} {{address.house_number}}</strong>
                <p ng-click="openPopup(address)" >{{address.description}}</p>
            </div>

            <form name="formAddress" ng-submit="saveEditAddress(formAddress, address)" ng-if="address.edit">
              <a href="#" ng-click="noEditAddress(address)" title="Volver" ><span class="glyphicon glyphicon-repeat pull-right"></span></a>
              <strong>{{address.road}} {{address.house_number}}</strong>
              
              <div class="form-group">
                <input type="text" class="form-control" name="description" ng-model="description" ng-value="description" placeholder="Descripcion" ng-change="changePopupMarker(formAddress)">
              </div>
            
              <button class="btn btn-primary">Guardar dirección</button>
              <button class="btn btn-primary" ng-click="noEditAddress(address)" >Cancelar</button>
            </form>

          </li>

          <!-- map click -->
          <li class="list-group-item" ng-if="edit">
            <a href="#" ng-click="deleteMarker(address)" title="Eliminar dirección" ><span class="glyphicon glyphicon-remove pull-right"></span></a>
            <form name="formAddress" ng-submit="saveAddress(formAddress, address)" >
              <strong>{{address.road}} {{address.house_number}}</strong>
              
              <div class="form-group">
                <input type="text" class="form-control" name="description" ng-model="description" ng-value="description" placeholder="Descripcion" ng-change="changePopupMarker(formAddress)">
              </div>
            
              <button class="btn btn-primary">Guardar dirección</button>
              <button class="btn btn-primary" ng-click="deleteMarker(address)" >Cancelar</button>
            </form>
          </li>
        </ul>
        
        <!-- search address -->
        <ul class="list-group" ng-show="isLoggedIn()">
         <li class="list-group-item">
            <div id="search-address" >

                <form name="formSearch" ng-submit="searchAddress(formSearch)" novalidate>
                  <strong>Busqueda por dirección</strong>        
                  <p class="input-group" >
                    <input type="text" class="form-control" placeholder="Calle de Peña Gorbea 1, Madrid" required ng-model="formSearch.search"> 
                    <span class="input-group-btn">
                      <button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-search"></span></button>
                    </span>  
                  </p>

                  <ul class="list-group" style="font-size:10px;" ng-if="searchResults.length > 0">
                    <li class="list-group-item" ng-repeat="result in searchResults">
                      <span ng-click="selectAddress(result)" >{{result.display_name}}</span>
                    <li>
                  </ul> 

                  <ul class="list-group" style="font-size:10px;" ng-if="searchResults.length == 0 && submitted">
                    <li class="list-group-item" >
                      No hay resultados, cambia la dirección
                    <li>
                  </ul>

                </form>
            </div>

      </div>
    </div>
  </div>

</div>


